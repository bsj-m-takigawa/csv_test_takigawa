# Issue #41: bulkDeleteの最適化と検証強化

## 問題の概要
現在のbulkDelete実装には、大量データ削除時のパフォーマンスとセキュリティに関する懸念があります。

## 現状の問題点

### 1. パフォーマンスの問題
- 大量のユーザーIDを一度に処理する際のメモリ使用量
- トランザクション内での大量削除によるデータベースロック時間
- 削除前の存在確認クエリのパフォーマンス

### 2. セキュリティの懸念
- 削除権限の検証が不十分
- 削除操作のログが基本的なレベル
- 誤操作による大量削除のリスク

### 3. エラーハンドリング
- 部分的な削除失敗時の処理が不明確
- ロールバック時の状態管理

## 影響範囲
- `backend/app/Http/Controllers/UserController.php` - bulkDeleteメソッド
- `backend/routes/api.php` - エンドポイント定義
- `frontend/src/lib/api/users.ts` - APIクライアント

## 提案する解決策

### 1. パフォーマンス最適化
```php
// チャンク処理による分割削除
$userIds = collect($validated['user_ids']);
$userIds->chunk(100)->each(function ($chunk) {
    User::whereIn('id', $chunk)->delete();
});
```

### 2. セキュリティ強化
- 削除確認トークンの実装
- 削除操作の詳細ログ記録
- 削除上限数の設定（例：一度に1000件まで）

### 3. エラーハンドリング改善
- 部分的成功/失敗の適切な処理
- 削除結果の詳細レポート返却

## 実装計画

### Phase 1: 基本的な最適化
1. チャンク処理の実装
2. 削除上限の設定
3. 基本的なログ強化

### Phase 2: セキュリティ強化
1. 削除確認トークンの実装
2. 監査ログの充実
3. 権限チェックの強化

### Phase 3: UI/UX改善
1. プログレスバー表示
2. 削除確認ダイアログの改善
3. 削除結果の詳細表示

## テスト要件
- 大量データ（10万件）での削除テスト
- 同時実行時の整合性テスト
- エラー発生時のロールバックテスト
- パフォーマンス測定（処理時間、メモリ使用量）

## 成功基準
- 10万件の削除が30秒以内に完了
- メモリ使用量が100MB以下
- エラー時の適切なロールバック
- 削除操作の完全な監査ログ